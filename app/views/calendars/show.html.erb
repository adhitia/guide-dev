<h1>Overview of "<%= h @calendar.name %>" Guide</h1>
<b>Location:</b>      <%= h @calendar.location.name %>  <b> | Times Viewed:</b>
<%= h @calendar.view_count %>
<b> | Times Clicked:</b>
<%= h @calendar.click_count %>

<p>
</p>
<div align="right">
  <a href="/calendars/<%= @calendar.id %>/share" class="textflow">view live version and get script</a>
</div>     <BR><BR>

<div id="view_tips">

  <table width="100%" border="1" cellpadding="0" cellspacing="0">

    <tr>
      <th></th>
      <% @weekdays.each do |day| %>
          <th>
            <div style="padding:10px">
            <%= day.name %>
            <% if @full_access %>
                <br/>
                <a href="/guides/<%= @calendar.id %>/edit#<%= day.name %>">edit</a>
            <% end %>
            </div>
          </th>
      <% end %>
    </tr>

    <% prev_cond = Condition.new %>
    <% @conditions.each do |condition| %>

        <!-- horizontal labels for 'day', 'dinner' and 'nigthlife' -->
        <% if condition.group != prev_cond.group %>
            <tr>
              <td class="headtext" colspan="20" align="center" style="background-color:#6666ff;">
                <%= condition.group %>
              </td>
            </tr>
        <% end %>
        <% prev_cond = condition %>

        <tr>

          <td>
            <!--left labels-->
            <div style="padding:10px">
            <%= condition.weather ? condition.weather : '' %> <%= condition.name %>
            <% if @full_access %>
                <br/>
                <a href="/guides/<%= @calendar.id %>/edit#<%= condition.name %>">edit</a>
            <% end %>
            </div>
          </td>

          <% @weekdays.each do |day| %>
              <% place = @calendar.show_places.detect { |t| t.condition.id == condition.id and t.weekday.id == day.id } %>
              <% tip = place == nil ? nil : place.tip %>

              <td valign="top" class="tip-container" condition_id="<%= condition.id %>" day_id="<%= day.id %>">
                <% if tip != nil then %>
                    <%= render :partial => 'tips/show_tile', :locals => {:place => place} %>
                <% else %>
                    <div class="no-tip-tile" align="center">
                      <button type="button" onclick="tips.create(this.parentNode, <%=condition.id%>, <%=day.id%>, '', 'show_tile');">
                        create tip
                      </button>
                    </div>
                <% end %>
              </td>


          <% end %>
        </tr>
    <% end %>

  </table>



</div>


<BR><BR>
<div align="right">
  <a href="/guides/<%= @calendar.id %>/share" class="textflow">view live version and get script</a>
</div>


<div id="new_tip" style="display:none;">
  <% form_tag("/guides/#{@calendar.id}/tips/create", :method => "post", :id => 'new_tip_form') do %>
      <input id="new_tip_name" name="new_tip_name"/>
  <% end %>
</div>
