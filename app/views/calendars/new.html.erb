

<div id="new_guide_page" >

<form id="new_calendar_form" name="new_calendar_form" class="with-watermark" action="<%= create_guide_path %>" method="POST">
  <input name="authenticity_token" type="hidden" value="<%= form_authenticity_token %>" />

  <h1>Create a Guide</h1>

  <div class="name-area">
    <h3>GUIDE NAME</h3>

    <div>
      <div class="column">
        <input id="calendar_name_location" class="watermark text-limit" title="location" name="calendar_name_location"
               type="text" value="<%= params[:calendar_name_location] %>" size="20" textLimit="20">
      </div>
      FOR
      <div class="column">
        <input id="calendar_name_target" class="watermark text-limit" title="target group" name="calendar_name_target"
               type="text" value="<%= params[:calendar_name_target] %>" size="20" textLimit="20">
      </div>
    </div>
    <p class="hint"> E.g., Rio for Partiers, Big Apple for Families </p>

  </div>


  <div class="location-area">
    <h4>Use weather info for </h4>

    <div class="input-area">
      <input id="calendar_location_name" name="location_name" size="25" value="<%= params[:location_name] %>" type="text" >
      <span style="position:absolute;left:50%;" class="location-loading"></span>
      <input id="calendar_location_code" name="location_code" value="<%= params[:location_code] %>" type="hidden" class="param_location_code">
    </div>

    <p class="hint">If you can not find your destination, type in the closest big city</p>
  </div>


  <div class="button-panel">
    <a href="javascript:" onclick="$('#new_calendar_form').submit();" class="button">
      NEXT
    </a>
  </div>

</form>





<script type="text/javascript">
    $(document).ready(function() {
        // initialize autocomplete for locations
        $('#calendar_location_name').each(function(i, e) {
            calendar.locationInput(e, function(input, result) {
                if (result == null) {
//                    if ($('#calendar_location_code').val() == '') {
//                        $('#calendar_location_name').val('');
//                    }
//                    $('#calendar_location_code').val('');
                } else {
                    $('#calendar_location_code').val(result.id);
                }
            });
        });


        $('#calendar_name_location').blur(function() {
            var loc = $(this).val();
            var target = $('#calendar_location_name');
            if (!common.empty(loc) && common.empty(target.val())) {
                target.val(loc);
                target.autocomplete('search');
            }
        });
    });

</script>


</div>