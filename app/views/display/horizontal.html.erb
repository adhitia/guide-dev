<!--condition bar takes additional space-->
<% has_condition_bar = @tips.select { |tip| !tip.condition.group.nil? }.length > 0 %>

<style type="text/css">
    .guide-template-1 {
        background-color: #FFFFFF;
        border: 2px solid gray;
        -moz-border-radius: 8px;
        -webkit-border-radius: 8px;
        border-radius: 8px;
        padding: 2px;
        display: inline-block;
        /*overflow: hidden;*/
        white-space: nowrap;
        font-size: small;
    }

    /* guide head */
    .guide-template-1 .guide-head {
        background-color: #DBDABD;
        color: #000000;
        font-size: medium;
        font-weight: bold;
        text-align: center;
        width: 120px;
        display: inline-block;
        vertical-align: top;
        height: 100%;
        white-space: normal;
    }

    .guide-template-1 .guide-head .guide-name {
        color: white;
    }

    .guide-template-1 .guide-head .guide-description {
    }

    .guide-template-1 .guide-head .guide-dow {
    }

    .guide-template-1 .condition-bar {
        height: 20px;
    }

    .guide-template-1 .condition-group {
        background-color: gray;
        text-align: center;
        margin: 0 1px;
        padding: 0;
        border: 0;
    }

    /* tips, main part */
    .guide-template-1 .guide-tips {
        display: inline-block;
        vertical-align: top;
        height: 100%;
        position: relative;
        white-space: normal;
    }

</style>









<!-- main guide container -->
<div class="guide-template-1" style="height:<%= has_condition_bar ? '124px' : '106px' %>">
  <!--header-->
  <div class="guide-head">
    <div class="guide-name">
      <a href="<%= WEB_ROOT %>/guides/<%= @calendar.id %>"><%= @calendar.name %></a>
    </div>
    <div class="guide-description">Travel tips for <%= @calendar.location.name %></div>
    <div class="guide-dow"><%= @dow.name %></div>
  </div>

  <!--tips-->
  <div class="guide-tips">
    <table border="0" cellpadding="0" cellspacing="0">
      <tbody>

      <% if has_condition_bar %>
          <tr class="condition-bar">
            <% @tips.map { |t| t.condition.group }.uniq.each do |group| %>
                <% columns = @tips.select { |t| t.condition.group == group }.length %>
                <td colspan="<%= columns %>">
                  <div class="condition-group">
                    <%= group %>
                  </div>
                </td>
            <% end %>
          </tr>
      <% end %>

      <tr>
        <% @tips.each do |tip| %>
            <td>
              <%= render :partial => 'display/tip/small', :locals => {:tip => tip} %>
            </td>
        <% end %>
      </tr>
      </tbody>
    </table>


  </div>

  <!--footer-->
  <%= render :partial => 'display/footer/normal', :locals => {:guide => @calendar, :style => 'small'} %>
</div>




