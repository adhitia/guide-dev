
<!--condition bar takes additional space-->
<% has_condition_bar = @tips.select{|tip| !tip.condition.group.nil?}.length > 0 %>

<style type="text/css">
    .guide-template-1 {
        background-color: #FFFFFF;
        border: 2px solid gray;
        -moz-border-radius: 8px;
        -webkit-border-radius: 8px;
        border-radius: 8px;
        padding: 2px;
        display:inline-block;
        overflow: hidden;
        white-space: nowrap;
    }

    /* guide head */
    .guide-template-1 .guide-head {
        background-color:#DBDABD;
        color: #000000;
        font-size: small;
        font-weight: bold;
        text-align: center;
        width: 120px;
        display: inline-block;
        vertical-align:top;
        height: 100%;
        white-space: normal;
    }

    .guide-template-1 .guide-head .guide-name {
        color: white;
    }

    .guide-template-1 .guide-head .guide-description {
    }

    .guide-template-1 .guide-head .guide-dow {
    }


    .guide-template-1 .condition-bar {
        height: 20px;
    }
    .guide-template-1 .condition-group {
        background-color:gray;
        /*margin-top:2px;*/
        text-align:center;
        /*display:inline-block;*/
        /*border: 1px solid;*/
        /*float: left;*/
        margin: 0 1px;
        padding: 0;
        border: 0;
    }


    /* tips, main part */

    .guide-template-1 .guide-tips {
        display: inline-block;
        vertical-align:top;
        height: 100%;
        position: relative;
        white-space: normal;
    }

    /* guide footer */
    .guide-template-1 .guide-footer {
        background-color: #DBDABD;
        color: #000000;
        font-size: small;
        width: 110px;
        display: inline-block;
        vertical-align:top;
        height: 100%;
        text-align: center;
        white-space: normal;
    }

    .guide-template-1 .guide-footer .select-day {
        text-align: center;
        color: #666666;
    }
    .guide-template-1 .guide-footer .select-day .previous-day {
        /*background: url("/images/arrowleft.gif") no-repeat;*/
        /*width: 12px;*/
        /*height: 12px;*/
    }
    .guide-template-1 .guide-footer .select-day .next-day {
    }

    .guide-template-1 .guide-footer .guide-info {
        font-size: x-small;
        color: #666666;
    }
</style>









<!-- main guide container -->
<div class="guide-template-1" style="height:<%= has_condition_bar ? '124px' : '106px' %>">
  <!--header-->
  <div class="guide-head">
    <div class="guide-name">
      <a href="<%=WEB_ROOT%>/guides/<%= @calendar.id %>"><%= @calendar.name %></a>
    </div>
    <div class="guide-description">Travel tips for <%= @calendar.location.name %></div>
    <div class="guide-dow"><%= @dow.name %></div>
  </div>

  <!--tips-->
  <div class="guide-tips">
    <table border="0" cellpadding="0" cellspacing="0">
      <tbody>

      <% if has_condition_bar %>
        <tr class="condition-bar">
          <% @tips.map { |t| t.condition.group }.uniq.each do |group| %>
              <% columns = @tips.select { |t| t.condition.group == group }.length %>
              <td colspan="<%= columns %>">
                <div class="condition-group">
                  <%= group %>
                </div>
              </td>
          <% end %>
        </tr>
      <% end %>

      <tr>
        <% @tips.each do |tip| %>
            <td>
              <%= render :partial => 'display/tip/small', :locals => {:tip => tip} %>
            </td>
        <% end %>
      </tr>
      </tbody>
    </table>


  </div>

  <!--footer-->
  <div class="guide-footer">
    <!-- date navigation -->
    <div class="select-day">
      <% if @day > 0 %>
          <a class="previous-day" href="javascript:" onclick="_guiderer.render(this, <%= @day - 1 %>);" title="View <%= @dow.prev.name %>">
            <img style="border: none;" src="<%= WEB_ROOT %>/images/arrowleft.gif"/>
          </a>
      <% end %>
      <%= @dow.name %>
      <% if @day < @forecast_full.length - 1 %>
          <a class="next-day" href="javascript:" onclick="_guiderer.render(this, <%= @day + 1 %>);" title="View <%= @dow.next.name %>">
            <img style="border: none;" src="<%= WEB_ROOT %>/images/arrowright.gif"/>
          </a>
      <% end %>
    </div>

    <div>
      <a href="<%=WEB_ROOT%>/guides/<%= @calendar.id %>" target="_blank">
        Whole week
      </a>
    </div>

    <!-- ratings go here -->
    Rate this guide:
    <div class="starbar">
      <div class="outer">
        <div class="inner" style="width:<%=Integer(@rating*20)%>px">
          <a class="s5" onclick="_guiderer.vote(this);" title="5"></a>
          <a class="s4" onclick="_guiderer.vote(this);" title="4"></a>
          <a class="s3" onclick="_guiderer.vote(this);" title="3"></a>
          <a class="s2" onclick="_guiderer.vote(this);" title="2"></a>
          <a class="s1" onclick="_guiderer.vote(this);" title="1"></a>
        </div>
      </div>
    </div>

    <!-- links and other info -->
    <div class="guide-info">
      <div class="guiderer-logo">
        <a href="<%= WEB_ROOT %>"> Powered by<br/>
        <img src="<%= WEB_ROOT %>/images/guiderer-logo-trasnp-tiny.gif" heigth=35 width=80 border="none"></a>
      </div>

      <div class="qtip-content" style="display:none;">
        <%= render :partial => 'display/hover/guide_info', :locals => {:guide => @calendar} %>
      </div>

    </div>

  </div>
</div>




